
---

# **Paper A 草稿 (Draft v1.0)**

## **標題：**

**Beyond the Newtonian Limit: Globalizing Solvability in Highly Anisotropic Hamiltonian Constraints via Pseudo-Transient Continuation**
**(超越牛頓極限：通過偽瞬態延拓實現高各向異性 Hamiltonian 約束的全局可解性)**

**摘要 (Abstract):**
在數值相對論的初值問題中，為了處理無限邊界或黑洞視界，往往需要引入極端的坐標變換（如雙曲正弦映射）。這類變換雖然解決了幾何拓撲問題，卻引入了強各向異性（High Anisotropy, ），導致橢圓型約束方程的 Jacobian 矩陣條件數呈指數級惡化。本文報告了一個關鍵發現：當各向異性超過特定閾值時，標準的牛頓-克雷洛夫（Newton-Krylov）方法會遭遇「信任域崩塌（Trust Region Collapse）」，表現為殘差的停滯或數值振蕩。為此，我們提出了一種基於**偽瞬態延拓（Pseudo-Transient Continuation, PTC）**的全局化求解架構。通過引入虛擬時間步長  作為同倫參數，結合**自適應對角預條件**與**幀內重試（In-Frame Retry）**機制，我們成功恢復了求解路徑的嚴格單調性。數值實驗表明，該方法能夠在極端拉伸網格上穩健地收斂，為高精度黑洞模擬提供了一個最小可行的數值框架。

---

## **1. 引言 (Introduction)**

廣義相對論的初值問題（Initial Value Problem）是數值相對論的基石。對於共形平坦的初值數據，問題簡化為求解非線性的 Hamiltonian 約束方程：



其中  是共形因子。

為了在有限的計算網格上處理物理上的無限區域，Koun-U 變換（及其變體 sinh-arcsinh mapping）被廣泛使用。然而，這種幾何映射在物理邊界附近引入了極大的網格拉伸率（Stretching Factor, ）。

傳統觀點認為，隨著  的增加，求解器的收斂速度會線性下降，可以通過增加迭代次數或改進預條件器來解決。**本文挑戰這一觀點。** 我們的研究表明，當  進入極端區間（例如  或更高，對應網格拉伸  倍），問題的性質發生了質變：

1. **線性化失效：** 在強非線性區域，標準牛頓步長給出的修正量  遠遠超出了物理上的信任域。
2. **方向迷失：** 由於 Jacobian 的條件數極差，線性求解器（如 GMRES）給出的方向可能與真實的非線性下降方向正交甚至相反。

這導致了標準求解器的「結構性斷裂」。為此，我們引入了 **偽瞬態延拓（PTC）**，將靜態邊值問題轉化為擬時間演化問題，從而「全局化（Globalize）」了可解性。

---

## **2. 方法論 (Methodology)**

我們構建了一個基於 JAX 的無矩陣牛頓-克雷洛夫求解器（JFNK），並實施了以下關鍵的穩定性策略。

### **2.1 偽瞬態延拓 (Pseudo-Transient Continuation)**

為了克服牛頓法的初值敏感性，我們構造了如下的時間演化方程：



離散化後，這等價於在每一層線性迭代中，對 Jacobian 矩陣的對角線進行增強：


* 當  時，算子由對角項主導，行為類似最速下降法，極其穩定但收斂慢。
* 當  時，算子回歸為 ，行為回歸為牛頓法，收斂快但不穩定。

我們的策略是 **SER (Switched Evolution Relaxation)**：從極小的  開始，隨著殘差的下降動態增大 。

### **2.2 自適應對角預條件 (Scale-Adaptive Preconditioning)**

在高各向異性網格中，Jacobian 的對角元素跨越了數個數量級。為了保證 GMRES 的有效性，我們設計了如下預條件器：



**關鍵創新點：** 我們對 Jacobian 的對角項取絕對值。這是因為在強引力場區域，質量項  可能導致局部對角元素為負。強制正定性保證了預條件器不會錯誤地翻轉梯度方向，確保了  始終是一個有效的下降算子。

### **2.3 幀內重試與嚴格單調性 (In-Frame Retry & Strict Monotonicity)**

傳統的線搜索（Line Search）在失敗時往往會浪費一次昂貴的線性求解。我們提出了一種 **「幀內重試」** 機制：

1. 如果當前步長  導致殘差上升（），我們**拒絕更新** 。
2. 不進入下一幀，而是立即在當前幀縮小 （通常乘以 0.5）。
3. 利用 JAX 的 `jit` 編譯優勢，快速重新求解線性系統。

這種機制保證了求解路徑的 **嚴格單調下降**，徹底消除了數值漂移（Drift）的風險。

---

## **3. 數值實驗與結果 (Numerical Experiments)**

我們在  的網格上，對  (基準) 進行了驗證測試。

### **3.1 實驗設置**

* **物理模型：** 雙黑洞拓撲的 Hamiltonian 約束。
* **參數：** 峰值密度 。
* **平台：** JAX (Float64精度)。

### **3.2 收斂行為分析**

我們對比了三種策略的表現：

1. **Naive Newton (無保護)：** 在前幾步即遭遇殘差發散或 NaN。
2. **Hard Clipping (硬截斷)：** 雖然防止了發散，但陷入了「僵死（Stagnation）」狀態，殘差停留在初始值附近無法下降。
3. **Robust PTC (本方法)：** 如下圖所示 [此處插入圖表]，殘差呈現出平滑的單調下降曲線。
* 在初期 ()，算法處於 PTC 區，殘差下降緩慢但穩定。
* 在中期 ()，算法成功渡過了非線性強烈的區域，未出現震盪。
* 在後期， 指數增長，算法平滑切換至牛頓區，展現出超線性收斂特徵。



### **3.3 臨界行為觀測**

實驗日誌顯示，在  附近，算法觸發了多次「幀內重試」。這證實了該區域是線性化假設與非線性曲率衝突最劇烈的「相變點」。我們的重試機制成功地充當了安全閥，防止了求解器崩潰。

---

## **4. 結論 (Conclusion)**

本文提出並驗證了一種適用於高各向異性相對論問題的數值求解架構。通過偽瞬態延拓與嚴格單調性控制的結合，我們克服了傳統牛頓法在極端網格拉伸下的結構性失效。

這一結果表明，對於 Koun-U 這類極端變換，可解性不再僅僅依賴於物理參數，更依賴於數值算法在「時間維度」上的演化路徑。這為未來實現更高解析度 () 的黑洞模擬奠定了堅實的方法論基礎。

---
