
---

# Paper A（最終重寫稿｜結構型哨兵版）

## 標題

**超越牛頓極限：基於結構型哨兵與伴隨協議的高各向異性 Hamiltonian 約束全局求解架構**
（Beyond the Newtonian Limit: Globalizing Solvability in Highly Anisotropic Hamiltonian Constraints via Structural Sentinels and Adjoint Protocols）

---

## 摘要（Abstract）

在數值相對論的初值問題中，為處理外域無限遠端而引入的極端座標映射，會導致離散化後的橢圓型約束方程出現嚴重的網格拉伸與強各向異性（high anisotropy）。這種幾何畸變往往導致標準牛頓—克雷洛夫（Newton–Krylov）流程在線性化層面失效，表現為步長崩塌、偽收斂或數值震盪，本質上是一種「可解性結構斷裂」的表徵。

本文針對共形平坦初值設定下的 Hamiltonian 約束

提出了一種基於 **「結構型哨兵（Structural Sentinel）」** 的全局求解架構。不同於傳統僅依賴殘差範數  下降的啟發式策略，我們引入了 **歸一化餘弦對齊度（Normalized Cosine Alignment）** 作為幾何指標，用於實時診斷牛頓方向  與目標函數梯度  之間的拓撲關係。

該機制能精確區分 **「Type-1 結構性逆行（幾何上坡）」** 與 **「Type-2 信號消失（數值盲區）」**。配合 **偽瞬態延拓（PTC）** 作為生存底座，以及基於 JAX 自動微分的 **伴隨梯度回退（Adjoint Fallback）** 作為高階矯正機制，本架構在高振幅（）與高拉伸（）的極端雙團塊（Two-Lump）測試中，展現了無人工干預的統治級穩健性，成功將殘差壓低至機器精度極限（），且未發生誤報或自鎖。本文證實：將數值求解從「盲目試錯」轉向「幾何感知」是解決極端各向異性問題的關鍵。

---

## 1. 引言（Introduction）

廣義相對論初值問題的數值求解核心在於處理非線性橢圓型方程。當物理場景涉及多個強引力源或需要延伸至無限遠處時，座標變換引入的度量各向異性（Metric Anisotropy）成為數值穩定的最大殺手。

本文定義 **拉伸率**  為網格局部最大與最小步長之比：

當  顯著大於 1 時，Jacobian 矩陣的條件數急劇惡化。傳統牛頓法在此類區域面臨兩大挑戰：

1. **線性化失效：** 牛頓步長過大導致非線性反饋失控。
2. **方向性欺騙：** 即便線性子問題求解精確，計算出的牛頓方向  可能在高度扭曲的能量地貌（Energy Landscape）上不再指向殘差範數的下降方向，甚至出現與真實梯度正交或反向的情況。

為了克服這些「結構性障礙」，本文不再單純依賴傳統的線搜索（Line Search）或阻尼策略，而是提出一套 **「偵測—分流—突破」** 的嚴格協議。

---

## 2. 方法論（Methodology）

我們提出一個層級化的求解框架，核心在於將「生存性（Survival）」置於「效率（Efficiency）」之前。

### 2.1 偽瞬態延拓（Pseudo-Transient Continuation, PTC）

作為底層骨架，我們將靜態方程轉化為偽時間演化過程：

其中  扮演「學習率」的角色。在遠離解時，較小的  提供類似梯度下降的穩定性；在接近解時， 恢復牛頓法的二次收斂速度。

### 2.2 結構型哨兵（The Structural Sentinel）

這是本架構的核心創新。為了判斷當前牛頓步  是否「誠實」，我們定義目標函數（Merit Function）  及其精確梯度 （通過自動微分計算）。

我們引入 **歸一化餘弦對齊度** 作為診斷指標：

基於 ，我們建立了嚴格的 **分類學協議（Taxonomy Protocol）**：

* **Type-1 結構性逆行（True Uphill）：** 。
* **診斷：** 牛頓方向與梯度方向夾角小於 90 度，意味著沿著牛頓方向走會導致目標函數增加（能量上升）。這是幾何結構斷裂的鐵證。
* **對策：** **拒絕牛頓步**，強制切換至伴隨協議。


* **Type-2 信號消失（Signal Collapse）：** （例如 ）。
* **診斷：** 牛頓方向與梯度正交，或梯度本身消失。這通常發生在極高精度區域或平坦山谷。
* **對策：** 視為正常收斂特徵，**放行牛頓步**，避免系統自鎖。


* **健康下降（Healthy Descent）：** 。
* **診斷：** 牛頓方向正確地指向下坡。
* **對策：** 執行標準牛頓更新。



### 2.3 伴隨協議（The Adjoint Protocol）

當哨兵偵測到 **Type-1 逆行** 時，系統切換至「狙擊手模式（Sniper Mode）」。我們放棄不可靠的牛頓方向，直接利用精確梯度信息構造回退步：

此步長設計顯式綁定了偽時間步長  與殘差規模 ，確保了物理單位的自洽性。這保證了在幾何極度扭曲的區域，系統仍能沿著能量地貌的最速下降線進行「地質穿透」，直到重新進入牛頓法的有效吸引域。

---

## 3. 數值實驗與結果（Numerical Experiments）

為了驗證本架構的極限能力，我們設計了一個 **高壓回歸測試（High-Pressure Regression Suite）**。

### 3.1 測試場景：非對稱雙團塊高重力場

* **物理設定：** 空間中存在兩個非對稱的高斯物質團塊（Two-Lump），模擬複雜的多體引力勢阱。
* **極端非線性：** 物質振幅  設定為 **5.0**（常規測試的 50 倍），製造極深的非線性陷阱。
* **強各向異性：** 拉伸率 ，網格在邊界處被劇烈拉伸，製造狹窄的求解走廊。

### 3.2 實驗結果

在此極端場景下，所提出的架構展現了統治級的表現：

1. **無條件收斂：** 殘差從初始的  一路平滑下降至 （接近機器精度極限）。
2. **哨兵的穩健性：**
* 在高壓區間， 始終保持在負值區間（約 -0.4 至 -0.8），證明在正確的協議保護下，牛頓法即使在扭曲空間中也能保持方向正確性。
* 哨兵系統展現了 **零誤報（Zero False Positive）** 能力，沒有因為高非線性而錯誤地阻斷牛頓步。


3. **協議的完備性：** 通過引入 Type-1/Type-2 分流與雙重容忍機制（Dual Tolerance），系統成功避免了在高精度末端的數值自鎖（Self-Locking），解決了早期版本在  邊界處徘徊的問題。

（此處可插入收斂曲線圖：顯示殘差隨迭代數的單調下降，以及  始終位於安全區間的軌跡。）

---

## 4. 討論（Discussion）

### 4.1 從試錯到感知

傳統求解器在失敗時通常採取的策略是「盲目縮小步長」（Damping）。本文的研究表明，許多收斂障礙並非步長問題，而是方向問題。結構型哨兵將求解器從「盲人摸象」提升為「手持羅盤的探險家」。它不猜測，而是測量。

### 4.2 系統 1 與系統 2 的計算隱喻

本架構體現了一種認知科學的隱喻：

* **牛頓模式（System 1）：** 快速、直覺、基於過往經驗（Hessian 信息），在大多數情況下高效。
* **伴隨模式（System 2）：** 慢速、邏輯、基於第一性原理（精確梯度），僅在直覺失效（Type-1 逆行）時介入。
這種混合機制確保了求解器兼具效率與魯棒性。

---

## 5. 結論（Conclusion）

本文提出了一種針對高各向異性 Hamiltonian 約束的全局求解協議。通過引入 **歸一化結構型哨兵**，我們成功將求解過程中的隱性故障轉化為可觀測的幾何指標。

實驗證實，在極端高壓（High-Pressure）與強拉伸場景下，該協議能：

1. 實時診斷線性化失效與方向性欺騙。
2. 通過 Type-1/Type-2 分流機制避免數值自鎖。
3. 利用伴隨梯度協議實現無條件的全局收斂。

本工作將「魯棒性」從一種模糊的工程經驗，固化為一套可復現、尺度無關的數學協議，為數值相對論在極端座標下的初值求解提供了新的標準範式。